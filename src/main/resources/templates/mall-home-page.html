<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <link rel="stylesheet" href="/css/css.css">
    <script src="/js/jquery-2.1.1.min.js"></script>

    <script type="text/javascript">
        $(function(){
            getDataOne();
            getUserName();
            getHiddenName();

            /*
            * 导购
            * */
            var content = "";
            $.ajax({
                url:"/home/getQueryDG",
                type:"POST",
                success:function(data){
                    $.each(data,function(index,obj){
                        content += "<li><a href=''>"+obj.groudName+"</a>";
                    });
                    $('#asd').html(content)
                },
                error:function(){
                    alert("失败了");
                }
            });
        })
        //分界线
        function getHiddenName() {
            var cookieVal = null;
            if (document.cookie != "" & document.cookie != null) {
                var cookie = document.cookie;
                var split = null;
                if (cookie != null) {
                    split = cookie.split(";");
                }
                var sp = split[1];
                var sp1 = sp.split("=");
                var sp2 = sp1[1];
                var sp3 = sp2.split("xjw1807b");
                cookieVal = sp3[0];
                console.log(cookieVal);
                $("#hidden1").val(sp3[0]);
            }
        }
        function getUserName() {
            var hiddenName = $("#hiddenName").val();
            console.log("作用域中的名字=======" + hiddenName);
            if (hiddenName != "" & hiddenName != null) {
                /*start*/
                var hiddenName = $("#hiddenName").val();
                if (hiddenName != null & hiddenName!="") {
                    console.log(hiddenName);
                    console.log("用户名为"+hiddenName);
                    $("#username1").html("你好  ,"+hiddenName);
                }
                /*end*/
            } else {
                var cookieVal = "";
                if (document.cookie != "" & document.cookie != null) {
                    var cookie=document.cookie
                    var s=cookie.split("=")
                    var sp=s[1]
                    var sp1=sp.split("xjw1807b");
                    var sp2=sp1[0]
                    cookieVal = sp2
                    $("#hidden1").val(cookieVal);
                }
                if (cookieVal == "" & cookieVal != null) {
                    $("#username1").html("<font color='red'>你好   ,请登录</font>");
                } else {
                    $("#username1").html("你好,   " + cookieVal + "    ,请登录");
                }}}
        ///分界线
        function toIndexes(class2,class1){
            alert("class2==="+class2);
            alert("class1==="+class1);
                $.ajax({
                        url:"/home/toIndexes",
                        type:"POST",
                        data:{class1:class1,class2:class2},
                        success:function(pageUtil){

                        },
                        error:function(){
                            alert("失败了");
                        }
                    });
        }
        function getDataTwo(id){
                $.ajax({
                        url:"/home/getAllClassTwoData",
                        type:"POST",
                        data:{id:id},
                        success:function(pageUtil){
                           var as = "";
                           $.each(pageUtil,function(index,obj){
                               as += "<a href='javascript:toIndexes("+obj.id+","+obj.flbh1+")'><font color='blue'>"+obj.flmch2+"</font></a>   ";
                           });
                           $("#div"+id+"").html(as);
                           $("#div"+id+"").show();
                        },
                        error:function(){
                            alert("失败了");
                        }
                    });
        }
        function getDataOne(){
            var content = "";
            var z = -1;
            $.ajax({      //查询一级分类的数据
                url:"/home/getAllClassOneData",
                type:"POST",
                success:function(pageUtil){
                    $.each(pageUtil,function(index,obj){
                        z++;
                        content += "<li><a href='javascript:getDataTwo("+obj.id+")'>"+obj.flmch1+"</a>";
                        content += "<div id='div"+obj.id+"' style='display:none;'></div></li>";      //创建每一个的子二级分类的“容器”
                    });
                    $('.nav_mini ul').html(content);
                },
                error:function(){
                    alert("失败了");
                }
            });
            $('.nav_mini ul li').hover(function(){
                $(this).find('.two_nav').show(100);
            },function(){
                $(this).find('.two_nav').hide(100);
            })
        }
    </script>
</head>
<body>
<div class="top">
    <div class="top_text">
        <a href="">用户登录</a>
        <a href="">用户注册</a>
        <a href="">供应商登录</a>
        <a href="">供应商注册</a>
        <input id="hiddenName" type="hidden" th:value="${session.userf?.name}">
        <input id="hidden1" type="hidden">
        <div id="username1"></div>
    </div>
</div>
<div class="top_img">
    <img src="http://m.360buyimg.com/babel/jfs/t1/27825/39/6000/28861/5c45676bEaaecfc4b/58a017e7412beb55.png" alt="">
</div>
<div class="search">
    <div class="logo"><img src="http://img20.360buyimg.com/da/jfs/t1/23377/26/6007/190377/5c46b6dcE6a2e665e/323a50ca6adbc492.gif?t=1548243688388" alt=""></div>
    <div class="search_on">
        <div class="se">
            <input type="text" name="search" class="lf">
            <input type="submit" class="clik" value="搜索">
        </div>
        <div class="se">
            <a href="">取暖神奇</a>
            <a href="">1元秒杀</a>
            <a href="">吹风机</a>
            <a href="">玉兰油</a>
        </div>
    </div>
    <div class="card">
        <a href="">购物车<div class="num">0</div></a>
    </div>
</div>
<div class="menu">
    <div class="nav">
        <div class="navs">
            <div class="left_nav">
                全部商品分类
                <div class="nav_mini">
                    <ul>

                    </ul>
                </div>
            </div>
            <ul>
                <li id="asd"></li>
            </ul>
        </div>
    </div>
</div>
<div class="banner">
    <div class="ban">
        <img src="/images/banner.jpg" width="980" height="380" alt="">
    </div>
</div>

</body>
</html>